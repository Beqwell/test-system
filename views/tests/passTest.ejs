<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pass Test</title>
    <script defer src="/js/timer.js"></script>
</head>
<body data-timer="<%= test.time_limit_minutes || 0 %>">
    <h1>Test: <%= test.title %></h1>

    <div id="timer-box" style="
        display: none;
        position: fixed;
        top: 10px;
        right: 15px;
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeeba;
        padding: 10px 15px;
        font-weight: bold;
        border-radius: 6px;
        z-index: 9999;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    ">
        ‚è≥ Time Left: <span id="timer"></span>
    </div>


    <form method="POST" action="/submit-test/<%= test.id %>" id="test-form">

        <input type="hidden" name="result_id" value="<%= resultId %>">
        <% questions.forEach((q, index) => { %>
            <div style="margin-bottom: 20px;">
                <strong><%= index + 1 %>. <%= q.text %></strong><br>

                <%- renderAttachmentHTML(q.attachment_path) %>

                <% if (q.type === 'one') { %>
                    <% q.answers.forEach(a => { %>
                        <label>
                            <input type="radio" name="answer_<%= q.id %>" value="<%= a.id %>">
                            <%= a.text %>
                        </label><br>
                    <% }) %>
                <% } else if (q.type === 'multi') { %>
                    <% q.answers.forEach(a => { %>
                        <label>
                            <input type="checkbox" name="answer_<%= q.id %>" value="<%= a.id %>">
                            <%= a.text %>
                        </label><br>
                    <% }) %>
                <% } else if (q.type === 'text') { %>
                    <input type="text" name="answer_<%= q.id %>"><br>
                <% } else if (q.type === 'number') { %>
                    <input type="number" step="any" name="answer_<%= q.id %>"><br>
                <% } %>
            </div>
        <% }) %>

        <button type="submit">Submit Test</button>
    </form>

    <br><a href="<%= backUrl || '/dashboard' %>">Back</a>

<script>
  console.log('[DEBUG] test page loaded');
  setInterval(() => {
    console.log('[DEBUG] still alive at', new Date().toISOString());
  }, 3000);
</script>

</body>
</html>
